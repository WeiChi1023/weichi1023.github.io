(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1e8ed4be"],{"3c54":function(t,e,c){},af65:function(t,e,c){"use strict";c("3c54")},b656:function(t,e,c){"use strict";c.d(e,"c",(function(){return i})),c.d(e,"g",(function(){return s})),c.d(e,"a",(function(){return a})),c.d(e,"d",(function(){return r})),c.d(e,"e",(function(){return l})),c.d(e,"f",(function(){return u})),c.d(e,"b",(function(){return d})),c.d(e,"h",(function(){return m}));var o=c("b775"),n=c("7b0f");function i(t){return Object(o["a"])({baseURL:Object(n["a"])(),url:"/mPOS/transaction/dailyAccount/".concat(t),method:"get"})}function s(t){return Object(o["a"])({baseURL:Object(n["a"])(),url:"/mPOS/transaction",method:"post",headers:{"Content-Type":"application/json"},data:t})}function a(t){return Object(o["a"])({baseURL:Object(n["a"])(),url:"/mPOS/transaction/void/reason",method:"post",headers:{"Content-Type":"application/json"},data:t})}function r(t){return Object(o["a"])({baseURL:Object(n["a"])(),url:"/mPOS/transaction/so",method:"post",headers:{"Content-Type":"application/json"},data:t})}function l(){return Object(o["a"])({baseURL:Object(n["a"])(),url:"/mPOS/transaction/so",method:"get",headers:{"Content-Type":"application/json"}})}function u(t,e,c){return Object(o["a"])({baseURL:Object(n["a"])(),url:"/mPOS/transaction/so/reprint/".concat(t,"/").concat(e),method:"post",headers:{"Content-Type":"application/json"},data:c})}function d(t){return Object(o["a"])({baseURL:Object(n["a"])(),url:"/mPOS/repair/".concat(t),method:"get"})}function m(t){return Object(o["a"])({baseURL:Object(n["a"])(),url:"/mPOS/status/printer/testprint",method:"post",headers:{"Content-Type":"application/json"},data:t})}},bf00:function(t,e,c){"use strict";c.r(e);var o=function(){var t=this,e=t.$createElement,c=t._self._c||e;return c("div",{staticClass:"bill-read"},[c("el-card",{staticClass:"box-card"},[c("el-form",{attrs:{inline:!0,"label-width":"auto"}},[c("span",{staticStyle:{"font-size":"28px"}},[t._v("機號： "+t._s(t.termNo))]),t._v(" "),c("span",{staticStyle:{color:"#222933"}},[t._v("---")]),t._v(" "),c("el-button",{attrs:{type:"primary"},nativeOn:{click:function(e){return t.settlementAndLogout()}}},[t._v("日結")])],1),t._v(" "),c("span",{staticStyle:{color:"#222933"}},[t._v("---")]),t._v(" "),c("el-divider"),t._v(" "),null!==t.pos?c("div",[c("el-table",{attrs:{data:t.tableOneData(t.pos).filter((function(t){return t.total>0})),border:""}},[c("el-table-column",{attrs:{prop:"categories",label:"項目 ",width:"150"}}),t._v(" "),c("el-table-column",{attrs:{prop:"elecInvoiceAccount",label:"電子發票"}}),t._v(" "),c("el-table-column",{attrs:{prop:"collectionAccount",label:"代收"}}),t._v(" "),c("el-table-column",{attrs:{prop:"total",label:"合計 （0 則不顯示）"}})],1),t._v(" "),c("div",{staticClass:"text item"},[c("span",[c("br")])]),t._v(" "),c("el-divider"),t._v(" "),c("el-table",{attrs:{data:t.tableTwoData(t.pos),height:"100",border:""}},[c("el-table-column",{staticStyle:{width:"20%"},attrs:{prop:"excessAmt",label:"溢收"}}),t._v(" "),c("el-table-column",{staticStyle:{width:"20%"},attrs:{prop:"reserveFund",label:"備用金"}}),t._v(" "),c("el-table-column",{staticStyle:{width:"20%"},attrs:{prop:"changes",label:"找零"}}),t._v(" "),c("el-table-column",{staticStyle:{width:"20%"},attrs:{prop:"safeFund",label:"收大數"}}),t._v(" "),c("el-table-column",{staticStyle:{width:"20%"},attrs:{prop:"drawerCash",label:"錢櫃現金"}})],1)],1):t._e(),t._v(" "),t.pos?t._e():c("div",[c("span",{staticStyle:{"font-size":"28px"}},[t._v("目前無法正常讀帳...")])])],1),t._v(" "),c("settle",{attrs:{"dialog-visible":t.settleView},on:{"update:dialogVisible":function(e){t.settleView=e},"update:dialog-visible":function(e){t.settleView=e}}})],1)},n=[],i=(c("96cf"),c("3b8d")),s=c("db72"),a=c("b656"),r=c("2f62"),l=c("f4a0"),u={name:"BillRead",components:{settle:l["a"]},data:function(){return{pos:null,mockReserveFund:5e3,mockESubtotal:8e3,mockCSubtotal:9900,mockCash:9900,mockTKGoodsAmt:8e3,mockDataUsage:!1,settleView:!1}},computed:Object(s["a"])({},Object(r["b"])(["termNo"])),created:function(){var t=this;Object(a["c"])(this.termNo).then((function(e){null===e?alert("目前無法正常讀帳"):t.pos=e}))},methods:{tableOneData:function(t){return[{categories:"小計",elecInvoiceAccount:this.mockDataUsage?this.mockESubtotal:t.elecInvoiceAccount.subtotal,collectionAccount:this.mockDataUsage?this.mockCSubtotal:t.collectionAccount.subtotal,total:this.mockDataUsage?this.mockESubtotal+this.mockCSubtotal:t.elecInvoiceAccount.subtotal+t.collectionAccount.subtotal},{categories:"現金",elecInvoiceAccount:t.elecInvoiceAccount.cash,collectionAccount:this.mockDataUsage?this.mockCash:t.collectionAccount.cash,total:this.mockDataUsage?this.mockCash+t.elecInvoiceAccount.cash:t.elecInvoiceAccount.cash+t.collectionAccount.cash},{categories:"信用卡",elecInvoiceAccount:t.elecInvoiceAccount.creditCardAmt,collectionAccount:t.collectionAccount.creditCardAmt,total:t.elecInvoiceAccount.creditCardAmt+t.collectionAccount.creditCardAmt},{categories:"新提貨券",elecInvoiceAccount:this.mockDataUsage?this.mockTKGoodsAmt:t.elecInvoiceAccount.TKGoodsAmt,collectionAccount:t.collectionAccount.TKGoodsAmt,total:this.mockDataUsage?this.mockTKGoodsAmt+t.collectionAccount.TKGoodsAmt:t.elecInvoiceAccount.TKGoodsAmt+t.collectionAccount.TKGoodsAmt},{categories:"他店提貨券",elecInvoiceAccount:t.elecInvoiceAccount.otherGoodsAmt,collectionAccount:t.collectionAccount.otherGoodsAmt,total:t.elecInvoiceAccount.otherGoodsAmt+t.collectionAccount.otherGoodsAmt},{categories:"他店禮券",elecInvoiceAccount:t.elecInvoiceAccount.PGAmt,collectionAccount:t.collectionAccount.PGAmt,total:t.elecInvoiceAccount.PGAmt+t.collectionAccount.PGAmt},{categories:"振興券",elecInvoiceAccount:t.elecInvoiceAccount.shoppingAmt,collectionAccount:t.collectionAccount.shoppingAmt,total:t.elecInvoiceAccount.shoppingAmt+t.collectionAccount.shoppingAmt},{categories:"賒帳",elecInvoiceAccount:t.elecInvoiceAccount.creditAmt,collectionAccount:t.collectionAccount.creditAmt,total:t.elecInvoiceAccount.creditAmt+t.collectionAccount.creditAmt},{categories:"還元金",elecInvoiceAccount:t.elecInvoiceAccount.FBAmt,collectionAccount:t.collectionAccount.FBAmt,total:t.elecInvoiceAccount.FBAmt+t.collectionAccount.FBAmt},{categories:"分期付款",elecInvoiceAccount:t.elecInvoiceAccount.termPayIntRateAmt,collectionAccount:t.collectionAccount.termPayIntRateAmt,total:t.elecInvoiceAccount.termPayIntRateAmt+t.collectionAccount.termPayIntRateAmt},{categories:"銀行紅利",elecInvoiceAccount:t.elecInvoiceAccount.bankPointsAmt,collectionAccount:t.collectionAccount.bankPointsAmt,total:t.elecInvoiceAccount.bankPointsAmt+t.collectionAccount.bankPointsAmt},{categories:"其他"}]},tableTwoData:function(t){return[{excessAmt:t.elecInvoiceAccount.excessAmt+t.collectionAccount.excessAmt,reserveFund:this.mockDataUsage?this.mockReserveFund:t.reserveFund,changes:t.changes,safeFund:t.safeFund,drawerCash:t.drawerCash}]},settlementAndLogout:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.settleView=!0;case 1:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()}},d=u,m=(c("af65"),c("2877")),p=Object(m["a"])(d,o,n,!1,null,"29496f9f",null);e["default"]=p.exports},df97:function(t,e,c){},f4a0:function(t,e,c){"use strict";var o=function(){var t=this,e=t.$createElement,c=t._self._c||e;return c("el-dialog",{attrs:{visible:t.dialogVisible,"before-close":t.beforeClose,"close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1,width:"50%"},on:{"update:visible":function(e){t.dialogVisible=e}}},[c("el-card",{staticClass:"box-card",attrs:{width:"max-content"}},[""!==t.propMsg?c("el-alert",{attrs:{title:t.propMsg,type:"error",center:"","show-icon":""}}):t._e(),t._v(" "),""!==t.errorMsg?c("el-alert",{staticStyle:{width:"100%","margin-bottom":"15px"},attrs:{title:t.errorMsg,type:"error",closable:!1}}):t._e(),t._v(" "),t.settleConfirmed?t._e():c("el-form",{ref:"confirmPage",attrs:{"label-position":""}},[c("el-form-item",[c("h3",{staticClass:"info"},[t._v("店號: "+t._s(t.systemInfo.storeNo))]),t._v(" "),c("h3",{staticClass:"info"},[t._v("機號: "+t._s(t.systemInfo.termNo))]),t._v(" "),c("h3",{staticClass:"info"},[t._v("營業日 "+t._s(t.businessDate))]),t._v(" "),c("h3",[t._v("確定要日結嗎？")]),t._v(" "),c("el-button-group",{staticStyle:{width:"100%"}},[c("el-button",{staticStyle:{width:"50%"},attrs:{type:"primary"},on:{click:function(e){return t.confirmed()}}},[t._v("確認")]),t._v(" "),c("el-button",{staticStyle:{width:"50%"},attrs:{type:"danger"},on:{click:function(e){return t.cancel()}}},[t._v("取消")])],1)],1)],1),t._v(" "),t.settleConfirmed?c("el-form",{ref:"inputForm"},[c("el-form-item",{attrs:{label:"使用者"}},[c("span",[t._v(t._s(t.user.name))])]),t._v(" "),c("el-form-item",{attrs:{label:"密碼",inline:!0}},[c("el-input",{staticStyle:{width:"55%"},nativeOn:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),t.submit(e))}},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}}),t._v(" "),c("el-button",{attrs:{type:"danger"},on:{click:function(e){return t.clearPassword()}}},[t._v("清除")])],1),t._v(" "),c("el-form-item",[c("el-button-group",{staticStyle:{width:"100%"}},[c("el-button",{staticStyle:{width:"50%"},attrs:{type:"primary"},on:{click:function(e){return t.submit()}}},[t._v("日結")]),t._v(" "),c("el-button",{staticStyle:{width:"50%"},attrs:{type:"danger"},on:{click:function(e){return t.cancel()}}},[t._v("取消")])],1)],1)],1):t._e()],1)],1)},n=[],i=(c("96cf"),c("3b8d")),s=c("db72"),a=c("2f62"),r=c("c24f"),l=c("4328"),u=c.n(l),d={name:"Settle",props:{dialogVisible:{type:Boolean,required:!1},submitData:{type:Object,default:function(){return null}},propMsg:{type:String,default:function(){return""}},propBusinessDate:{type:String,default:function(){return""}}},data:function(){return{errorMsg:"",settleConfirmed:!1,password:"",businessDate:""}},computed:Object(s["a"])({},Object(a["c"])({systemInfo:function(t){return t.systemInfo},user:function(t){return t.user}}),{},Object(a["b"])(["termNo"])),watch:{dialogVisible:function(t){""===this.propBusinessDate?this.businessDate=this.systemInfo.businessDate:this.businessDate=this.propBusinessDate}},created:function(){},methods:{confirmed:function(){null!==this.submitData?(this.$store.dispatch("user/settlement2",this.submitData),this.beforeClose()):this.settleConfirmed=!0},cancel:function(){Object.assign(this.$data,this.$options.data()),this.$store.dispatch("user/clearErrorMsg"),this.$emit("update:dialogVisible",!1)},clearPassword:function(){this.password=""},verify:function(){""===this.password?(this.valid=!1,this.errorMsg="未輸入密碼"):(this.errorMsg="",this.valid=!0)},settle:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$store.dispatch("user/settlement2",e);case 2:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),logout:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$store.dispatch("user/logout");case 2:this.$router.push("/login");case 3:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),submit:function(){var t=this;this.errorMsg="",new Promise((function(e,c){Object(r["a"])(u.a.stringify({userId:t.user.userId,userPassword:t.password,termNo:t.termNo})).then((function(c){var o={userId:t.user.userId,termNo:t.systemInfo.termNo};t.logout().then((function(){t.settle(o)})),e()})).catch((function(t){c(t)}))}))},beforeClose:function(){Object.assign(this.$data,this.$options.data()),this.$emit("update:dialogVisible",!1)}}},m=d,p=(c("f530"),c("2877")),b=Object(p["a"])(m,o,n,!1,null,"6283255f",null);e["a"]=b.exports},f530:function(t,e,c){"use strict";c("df97")}}]);